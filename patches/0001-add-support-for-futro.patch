From 7c749b9250367d6eb4c1d0b978cecc13c1a5e919 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Karsten=20B=C3=B6ddeker?= <freifunk@kb-light.de>
Date: Thu, 15 Oct 2015 16:35:06 +0200
Subject: [PATCH] add support for futro
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Karsten Böddeker <freifunk@kb-light.de>
---
 patches/openwrt/1000-Add-support-for-futro.patch | 50 ++++++++++++++++++++++++
 targets/x86-generic/profiles.mk                  |  4 +-
 2 files changed, 53 insertions(+), 1 deletion(-)
 create mode 100644 patches/openwrt/1000-Add-support-for-futro.patch

diff --git a/patches/openwrt/1000-Add-support-for-futro.patch b/patches/openwrt/1000-Add-support-for-futro.patch
new file mode 100644
index 0000000..9efa901
--- /dev/null
+++ b/patches/openwrt/1000-Add-support-for-futro.patch
@@ -0,0 +1,50 @@
+From: Karsten Böddeker <freifunk@kb-light.de>
+Date: Thu, 15 Oct 2015 14:40:53 +0200
+Subject: Add support for futro
+
+diff --git a/package/kernel/linux/modules/usb.mk b/package/kernel/linux/modules/usb.mk
+index 96c899a..0c531ca 100644
+--- a/package/kernel/linux/modules/usb.mk
++++ b/package/kernel/linux/modules/usb.mk
+@@ -1439,3 +1439,32 @@ define KernelPackage/usb3/description
+ endef
+
+ $(eval $(call KernelPackage,usb3))
++
++define KernelPackage/usb-net-rtl8150
++  TITLE:=Kernel module for USB-to-Ethernet Realtek convertors
++  KCONFIG:=CONFIG_USB_RTL8150
++  FILES:=$(LINUX_DIR)/drivers/$(USBNET_DIR)/rtl8150.ko
++  AUTOLOAD:=$(call AutoProbe,rtl8150)
++  $(call AddDepends/usb-net)
++endef
++
++define KernelPackage/usb-net-rtl8150/description
++ Kernel module for USB-to-Ethernet Realtek 8150 convertors
++endef
++
++$(eval $(call KernelPackage,usb-net-rtl8150))
++
++
++define KernelPackage/usb-net-rtl8152
++  TITLE:=Kernel module for USB-to-Ethernet Realtek convertors
++  KCONFIG:=CONFIG_USB_RTL8152
++  FILES:=$(LINUX_DIR)/drivers/$(USBNET_DIR)/r8152.ko
++  AUTOLOAD:=$(call AutoProbe,r8152)
++  $(call AddDepends/usb-net)
++endef
++
++define KernelPackage/usb-net-rtl8152/description
++ Kernel module for USB-to-Ethernet Realtek 8152 USB2.0/3.0 convertors
++endef
++
++$(eval $(call KernelPackage,usb-net-rtl8152))
+diff --git a/target/linux/x86/generic/config-3.10 b/target/linux/x86/generic/config-3.10
+index 2babaab..12d1c7f 100644
+--- a/target/linux/x86/generic/config-3.10
++++ b/target/linux/x86/generic/config-3.10
+@@ -201,3 +201,4 @@ CONFIG_VT_CONSOLE=y
+ CONFIG_X86_PM_TIMER=y
+ # CONFIG_XO15_EBOOK is not set
+ # CONFIG_ZISOFS is not set
++CONFIG_PATA_ATIIXP=y
diff --git a/targets/x86-generic/profiles.mk b/targets/x86-generic/profiles.mk
index b6551a7..a8a068d 100644
--- a/targets/x86-generic/profiles.mk
+++ b/targets/x86-generic/profiles.mk
@@ -1,4 +1,6 @@
-X86_GENERIC_NETWORK_MODULES := kmod-3c59x kmod-e100 kmod-e1000 kmod-e1000e kmod-natsemi kmod-ne2k-pci kmod-pcnet32 kmod-8139too kmod-r8169 kmod-sis900 kmod-tg3 kmod-via-rhine kmod-via-velocity
+X86_GENERIC_NETWORK_MODULES := kmod-3c59x kmod-e100 kmod-e1000 kmod-e1000e kmod-natsemi kmod-ne2k-pci kmod-pcnet32 kmod-8139too kmod-r8169 kmod-sis900 kmod-tg3 kmod-via-rhine kmod-via-velocity \
+       kmod-usb-core kmod-usb2 kmod-usb-hid kmod-usb-net kmod-usb-net-asix kmod-usb-net-rtl8150 kmod-usb-net-rtl8152 kmod-usb-net-dm9601-ether
+


 $(eval $(call GluonProfile,GENERIC,$(X86_GENERIC_NETWORK_MODULES)))
--
2.1.4
